## Introdução aos Itens do Jogo

Neste documento são descritos vários scripts que definem comportamentos para diferentes itens em um jogo, cada um estendendo funcionalidades de base como `StaticBody2D`, `Area2D`, ou `AudioStreamPlayer`. Cada script desempenha um papel crucial na interatividade e na lógica do jogo, contribuindo para diversas mecânicas, desde portas que se abrem e fecham até checkpoints e transições musicais dinâmicas.

### `door.gd`

- **Descrição**: Controla a abertura e o fechamento de uma porta no jogo.
- **Funções**:
  - `openDoor()`: Desativa o `CollisionShape2D` da porta e a esconde.
  - `closeDoor()`: Ativa o `CollisionShape2D` da porta e a exibe.

### `drone.gd`

- **Descrição**: Gerencia um drone no jogo, que muda de cena quando o jogador entra na área definida.
- **Variáveis Exportadas**:
  - `fase`: Cena para a qual o jogador deve transitar.
  - `GUI`: Camada do canvas associada para exibir transições.
  - `text`: Texto exibido ao mudar de cena.
  - `helper`: Stream de áudio usado para efeitos sonoros.

### `checkpoint.gd`

- **Descrição**: Implementa um checkpoint no jogo, ativado quando o jogador entra na área.
- **Variáveis Exportadas**:
  - `themes`: Array de temas que define o estado do jogo no checkpoint.
  - `saveFirstCollision`: Booleano para determinar se o estado do jogo deve ser salvo no primeiro contato.
  - `mudarObjetivo`: Booleano para mudar o objetivo exibido na interface.
  - `objetivoPrincipal`, `objetivosSecundarios`: Textos usados para definir objetivos na interface.

### `music.object.gd`

- **Descrição**: Controla a reprodução de músicas no jogo usando `AudioStreamPlayer`.
- **Funcionalidades**:
  - Inicia a música principal do jogo ou transições de músicas baseadas em eventos no jogo.
  - Gerencia o volume da música conforme definido globalmente.

Esses scripts formam a base para a jogabilidade e a experiência sonora do jogo, integrando-se à lógica geral do jogo para proporcionar uma experiência envolvente aos jogadores. Cada script é projetado para ser modular e reutilizável, facilitando a manutenção e expansão do jogo conforme necessário.


### `plataform.object.gd`

Este script define o comportamento de um objeto `Area2D` que interage com o personagem jogador em um ambiente de jogo.

### Variáveis Exportadas

- **`label: String`**: Define o rótulo exibido pelo objeto.
- **`disable_collision: bool`**: Controla se a colisão está desabilitada.
- **`correct: bool`**: Indica se o objeto é um item correto ou não.
- **`manualValue: String`**: Valor manual do rótulo quando `manual` é verdadeiro.

### Variáveis de Script

- **`shockSong`**: Áudio de choque carregado do arquivo "res://sounds/enemy/shock.mp3".
- **`manual: bool`**: Indica se o valor do rótulo é definido manualmente.
- **`size: Vector2`**: Armazena o tamanho do objeto, calculado durante o `_ready()`.

### Funções

#### `_ready()`

Inicializa o objeto quando ele entra na árvore da cena:
- Calcula o tamanho do objeto.
- Verifica se o rótulo deve ser definido manualmente e chama `setLabel()`.

#### `_on_body_entered(body)`

Chamada quando um corpo entra na área do objeto:
- Verifica se o corpo é o jogador.
- Se não for o item correto, aplica um efeito de knockback no jogador e incrementa `Globals.wrongAnswers`.
- Executa animações e sons de acordo com a interação.

#### `_on_animated_sprite_2d_animation_finished()`

Chamada quando a animação do sprite animado é concluída:
- Reinicia a animação para "disabled" após a execução da animação "enabled".

#### `setLabel(labelstr, collision = true)`

Define o rótulo do objeto e controla a colisão:
- Atualiza o texto do rótulo com `labelstr`.
- Habilita ou desabilita a colisão do objeto com base no parâmetro `collision`.

### Utilização

Este script é utilizado para controlar o comportamento de objetos interativos no jogo, permitindo interações com o jogador e modificação dinâmica de rótulos e comportamentos de colisão.

## `stairs.gd`

Este script define uma área no jogo que permite a transição para a próxima fase quando o jogador entra nela, desde que tenha coletado um número específico de moedas.

### Variáveis Exportadas

- **`fase`**: Arquivo exportado que define a próxima cena a ser carregada quando o jogador entra na área.
- **`GUI: CanvasLayer`**: Camada de interface gráfica associada à transição de cena.

### Funções

#### `_ready()`

- **Descrição**: Chamada quando o nó entra na árvore da cena pela primeira vez.
- **Ação**: Conecta o sinal `transitionFinished` da GUI, se estiver definida.

#### `transitionFinished(node)`

- **Descrição**: Chamada quando a transição de cena é concluída na GUI.
- **Parâmetros**:
  - `node`: O nó que disparou o sinal.
- **Ação**: Altera a cena utilizando o método `SceneManager.changeScene(fase)` se o `node` for o próprio nó (`self`).

#### `_on_body_entered(body)`

- **Descrição**: Chamada quando um corpo entra na área.
- **Parâmetros**:
  - `body`: O corpo que entrou na área.
- **Ação**: Verifica se o corpo é o jogador (`body.name == "player"`) e se o número de moedas coletadas é igual a 20 (`$"..".coins == 20`). Se ambas as condições forem verdadeiras:
  - Define o ponto de verificação do jogador como nulo (`Globals.playerCheckpoint = null`).
  - Adiciona "levelB" à lista de níveis completos (`Globals.completedLevels.append("levelB")`).
  - Chama o método `finishLevel()` na GUI se ela estiver definida.

### Utilização

Este script é utilizado para gerenciar a transição para a próxima fase do jogo quando o jogador entra na área, desde que tenha coletado o número especificado de moedas. Ele também se conecta à interface gráfica para concluir a transição de cena de forma adequada.

## `alarm.gd`

Este script estende `TileMap` e controla a ativação e desativação de camadas específicas do tilemap para gerenciar alarmes no jogo.

### Funções

#### `enableAlarms()`

- **Descrição**: Habilita os alarmes no mapa.
- **Ação**:
  - Desativa a camada 1 (`set_layer_enabled(1, false)`) que pode conter tiles representando alarmes ativos.
  - Ativa a camada 2 (`set_layer_enabled(2, true)`) que pode conter tiles representando alarmes desativados.

#### `disableAlarms()`

- **Descrição**: Desabilita os alarmes no mapa.
- **Ação**:
  - Ativa a camada 1 (`set_layer_enabled(1, true)`) para mostrar tiles que representam alarmes ativos.
  - Desativa a camada 2 (`set_layer_enabled(2, false)`) que pode conter tiles representando alarmes desativados.

### Utilização

Este script é utilizado para controlar visualmente a ativação e desativação de alarmes no tilemap do jogo. Ele manipula camadas específicas do tilemap para mostrar visualmente o estado dos alarmes no ambiente do jogo.


## `interaction.gd`

Este script estende `Area2D` e controla interações entre o jogador e outras áreas no jogo.

### Funções

#### `_on_body_entered(body)`

- **Descrição**: Chamada quando um corpo entra na área.
- **Parâmetros**:
  - `body`: O corpo que entrou na área.
- **Ação**:
  - Verifica se o `body` que entrou tem o nome "player".
  - Chama `body.zoom(true)` para iniciar o zoom no jogador.
  - Define `body.velocity` como `Vector2.ZERO` para parar o movimento do jogador.

#### `_on_body_exited(body)`

- **Descrição**: Chamada quando um corpo sai da área.
- **Parâmetros**:
  - `body`: O corpo que saiu da área.
- **Ação**:
  - Verifica se o `body` que saiu tem o nome "player".
  - Chama `body.zoom(false)` para encerrar o zoom no jogador.

### Utilização

Este script é usado para controlar interações específicas entre o jogador e outras áreas no jogo. Quando o jogador entra na área controlada por este script, ele executa a função de zoom no jogador e interrompe seu movimento. Quando o jogador sai da área, o zoom é desativado.

## `wiring_panel.gd`

Este script estende `TextureRect` e controla um painel de fiação interativa no jogo.

### Variáveis

- **`cutSong`**: Áudio a ser reproduzido ao cortar um fio.
- **`connectSong`**: Áudio a ser reproduzido ao conectar um fio.
- **`sucessSong`**: Áudio a ser reproduzido ao completar com sucesso a conexão dos fios.
- **`connectHelper`**: Áudio de ajuda para a conexão.
- **`files`**: Objeto para obter arquivos de uma pasta.
- **`random`**: Gerador de números aleatórios.
- **`actualControl`**: Controle atual.
- **`shape`**: Forma atual.
- **`line`**: Objeto `Line2D` para desenhar linhas entre os controles.
- **`lineIsConnect`**: Variável para indicar se a linha está conectada.
- **`connectStep`**: Passo atual de conexão.
- **`helpers`**: Áudios de ajuda disponíveis.
- **`helper`**: Áudio de ajuda atualmente reproduzindo.

### Métodos

#### `activate()`

- **Descrição**: Inicia a interação com o painel de fiação.
- **Ação**:
  - Conecta o sinal `transitionFinished` do pai do pai para `transitionFinished`.
  - Seleciona uma forma aleatória e inicia a reprodução da ajuda correspondente.
  - Define o texto de instruções com base na forma selecionada.
  - Conecta os sinais `button_down` e `button_up` de cada controle para `cut` e `setLineNull`, respectivamente.

#### `setLineNull()`

- **Descrição**: Limpa a linha atual, se existir.

#### `setLines()`

- **Descrição**: Configura as linhas iniciais entre os controles.

#### `cut(control)`

- **Descrição**: Chamado ao cortar um fio.
- **Parâmetros**:
  - `control`: O controle onde o fio foi cortado.
- **Ação**:
  - Verifica se o corte é correto ou não.
  - Oculta a linha conectada ao controle cortado.
  - Define a forma como nula no array `linesAndShapes` se o corte for correto.
  - Inicia a animação de clique no tesoura e reproduz o áudio correspondente.
  - Incrementa `Globals.wrongAnswers` e chama `healthbar_obj.hit()` se o corte for incorreto.
  - Se todas as formas forem cortadas, define `connectStep` como verdadeiro.

#### `setNewLineToCut()`

- **Descrição**: Seleciona uma nova linha para ser cortada, se houver mais linhas disponíveis.

#### `filterLinesAndShapes()`

- **Descrição**: Filtra as formas que ainda não foram cortadas.

#### `_input(event)`

- **Descrição**: Manipula eventos de entrada durante o passo de conexão.
- **Parâmetros**:
  - `event`: Evento de entrada.
- **Ação**:
  - Durante o passo de conexão, permite arrastar a linha para conectar os controles.
  - Se a linha estiver próxima ao alvo (`target`), ajusta sua posição para conectar os controles.
  - Quando todos os controles estiverem conectados, reproduz o áudio de sucesso e finaliza o nível.

#### `transitionFinished(node)`

- **Descrição**: Chamado quando a transição de cena é concluída.
- **Parâmetros**:
  - `node`: O nó que completou a transição.
- **Ação**:
  - Finaliza o nível e define `Globals.playerCheckpoint` como nulo.
  - Salva a posição da música e muda para a cena de fim de jogo.

#### `_on_scissor_animation_finished()`

- **Descrição**: Chamado quando a animação da tesoura é concluída.
- **Ação**:
  - Reinicia a animação da tesoura para o estado "idle".

#### `playHelper(shapeName)`

- **Descrição**: Reproduz o áudio de ajuda correspondente à forma especificada.
- **Parâmetros**:
  - `shapeName`: Nome da forma para reproduzir o áudio de ajuda.

## `lock.item.gd`

Este script estende `TextureRect` e controla um item de jogo que simula um cadeado com dígitos ajustáveis para desbloqueio.

### Variáveis

- **`generateMath`**: Instância do script `generate_math_expression.gd` para geração de expressões matemáticas.
- **`arrowClickSong`**: Áudio reproduzido ao clicar nas setas de ajuste.
- **`buttonConfirmSong`**: Áudio reproduzido ao pressionar o botão de confirmação.
- **`unlockedSong`**: Áudio reproduzido ao desbloquear o cadeado.
- **`pegarseta`**: Referência para o último objeto de seta clicado.
- **`maxcontas`**: Variável não utilizada.
- **`resultado`**: Resultado da expressão matemática gerada para o cadeado.
- **`indice`**: Índice para controlar o número de tentativas de desbloqueio.

### Sinais

- **`unlocked()`**: Emitido quando o cadeado é desbloqueado com sucesso.
- **`hit()`**: Sinal não conectado neste script.

### Métodos

#### `activate()`

- **Descrição**: Inicia a interação com o cadeado.
- **Ação**:
  - Gera a primeira expressão matemática para o cadeado.
  - Conecta os sinais `pressed` das setas para o método `_passar`.

#### `_passar(setascadeado)`

- **Parâmetros**:
  - `setascadeado`: Nome da seta que foi clicada.
- **Ação**:
  - Ajusta o valor numérico conforme a seta clicada (`setacima` ou `setabaixo`).

#### `_checar()`

- **Descrição**: Verifica se o código inserido no cadeado está correto.
- **Ação**:
  - Obtém os valores dos dígitos digitados.
  - Verifica se o código é igual ao resultado da expressão matemática atual.
  - Reinicia o processo se o código estiver correto ou aumenta o contador de respostas erradas.
  - Emite o sinal `unlocked` se o cadeado for desbloqueado após três tentativas corretas.

#### `_conta()`

- **Descrição**: Gera uma nova expressão matemática para o cadeado.
- **Retorno**: Retorna a expressão matemática gerada e atualiza o texto digital exibido.

#### `_on_confirm_pressed()`

- **Descrição**: Chamado quando o botão de confirmação é pressionado.
- **Ação**:
  - Reproduz o som de confirmação.
  - Chama `_checar()` para verificar se o código digitado está correto.

#### `_on_animation_player_animation_finished(anim_name)`

- **Parâmetros**:
  - `anim_name`: Nome da animação que foi finalizada.
- **Ação**:
  - Emite o sinal `unlocked` quando a animação de desbloqueio (`unlocked`) é concluída.

## `coin.gd`

Este script gerencia o comportamento de uma moeda coletável no jogo.

### Variáveis

- **`anim`**: Referência para o `AnimatedSprite2D` usado para animar a moeda.
- **`hud`**: Referência para o nó do HUD (Heads-Up Display) atual na cena.

### Sinais

- **`collected_coin`**: Emitido quando a moeda é coletada.

### Métodos

#### `_ready()`

- **Descrição**: Chamado quando o nó entra na árvore da cena pela primeira vez.
- **Ação**:
  - Inicia a animação de loop da moeda.
  - Obtém uma referência ao nó do HUD na cena atual.

#### `_on_area_2d_body_entered(body)`

- **Parâmetros**:
  - `body`: Corpo que entrou na área 2D (normalmente o jogador).
- **Ação**:
  - Verifica se o corpo que entrou na área é o jogador.
  - Emite o sinal `collected_coin` e atualiza o HUD ao coletar a moeda.
  - Incrementa o contador de moedas da fase se a cena atual for "fase_tutorial_primeiro_andar".

#### `collected()`

- **Descrição**: Executa as ações associadas à coleta da moeda.
- **Ação**:
  - Reproduz um efeito sonoro de coleta.
  - Incrementa o contador global de moedas (`Globals.totalCoins`).
  - Instancia e emite partículas de efeito.
  - Esconde o `AnimatedSprite2D` da moeda, aguarda um curto período e libera o nó da moeda.

#### `_process(delta)`

- **Parâmetros**:
  - `delta`: Tempo decorrido desde o último quadro.
- **Ação**: Não realiza nenhuma ação neste script.

## `bucket.item.gd`

Este script gerencia um componente de entrada de texto (provavelmente um campo de senha ou entrada numérica) que utiliza botões para entrada de dados.

### Sinais

- **`bucketValueChanged(text)`**: Emitido quando o valor do balde (bucket) é alterado.

### Métodos

#### `activate()`

- **Descrição**: Ativa a conexão dos sinais dos botões de entrada.
- **Ação**:
  - Conecta o sinal `pressed` dos botões no nó `buttons` para chamar `buttonPressed` passando o nome do botão.

#### `_on_line_edit_text_submitted(new_text)`

- **Parâmetros**:
  - `new_text`: O novo texto submetido no campo de edição.
- **Ação**:
  - Emite o sinal `bucketValueChanged` com o novo texto submetido.

#### `buttonPressed(value)`

- **Parâmetros**:
  - `value`: O valor associado ao botão pressionado.
- **Ação**:
  - Se o `value` for `"ok"`, chama `_on_line_edit_text_submitted` com o texto atual do campo de edição.
  - Se o `value` for `"remove"`, limpa o conteúdo do campo de edição.
  - Caso contrário, concatena `value` ao texto atual do campo de edição.

#### Métodos de botões numerados (`_on__pressed_X()`)

- **Descrição**: Métodos para botões numéricos (de 0 a 9) e "ok" e "remove".
- **Ação**:
  - Chamam `buttonToNumber` com o valor correspondente ao botão pressionado.

#### `buttonToNumber(value: String)`

- **Parâmetros**:
  - `value`: O valor associado ao botão pressionado.
- **Ação**:
  - Chama `buttonPressed` com o `value` fornecido.

#### Métodos de botões específicos (`_on_ok_pressed_ok()` e `_on_remove_pressed_remove()`)

- **Descrição**: Métodos para botões específicos "ok" e "remove".
- **Ação**:
  - Chamam `buttonToNumber` com o valor correspondente ao botão pressionado.

## `biotech.item.gd`

Este script gerencia um componente de biotecnologia que inclui um teclado virtual para entrada de dados e botões de controle.

### Sinais

- **`bioPadConfirmationValue(confirmedValue)`**: Emitido quando um valor é confirmado no teclado virtual.
  - **`confirmedValue`**: O valor confirmado pelo usuário.

### Variáveis

- **`hideIcon`**: Ícone para esconder o componente.
- **`viewIcon`**: Ícone para exibir o componente.
- **`clickSong`**: Som reproduzido ao clicar em botões.
- **`confirmSong`**: Som reproduzido quando um valor é confirmado.
- **`files`**: Instância de um script para obter arquivos de uma pasta.

### Métodos

#### `activate()`

- **Descrição**: Configura a funcionalidade dos botões de entrada do teclado virtual.
- **Ação**:
  - Exibe ou oculta a ajuda com base no estado de `Globals.questionContents`.
  - Conecta o sinal `pressed` dos botões no nó `letterButtons`, `numberButtons` e `controllerButtons` para chamar `bioPadButtonPressed` com o nome do botão pressionado.

#### `bioPadButtonPressed(button)`

- **Parâmetros**:
  - `button`: Nome do botão pressionado.
- **Ação**:
  - Se `button` for `"ok"`, emite o sinal `bioPadConfirmationValue` com o texto atual de `$output.text` em letras maiúsculas, e limpa o campo de saída. Reproduz o som `confirmSong`.
  - Se `button` for `"clear"`, limpa o campo de saída `$output.text` e reproduz o som `clickSong`.
  - Para outros botões, concatena o valor ao campo de saída `$output.text` se o comprimento for menor que 2 ou igual a "10". Reproduz o som `clickSong`.

#### `_on_output_text_submitted(new_text)`

- **Parâmetros**:
  - `new_text`: O novo texto submetido no campo de saída.
- **Ação**:
  - Emite o sinal `bioPadConfirmationValue` com `new_text` em letras maiúsculas e limpa o campo de saída `$output.text`.

#### `changeHelper(helper)`

- **Parâmetros**:
  - `helper`: Nome do helper para exibir no componente.
- **Ação**:
  - Configura o texto de ajuda baseado no helper recebido.
  - Seleciona aleatoriamente um áudio de ajuda correspondente ao helper, se disponível.

#### `_on_close_pressed()`

- **Ação**:
  - Alterna a visibilidade do componente entre visível e invisível.
  - Altera o ícone do botão "close" para `viewIcon` ou `hideIcon` conforme o estado de visibilidade do componente. Reproduz o som `clickSong` ao alterar a visibilidade.

