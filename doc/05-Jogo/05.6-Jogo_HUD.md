## `dialog.gd`

Este script gerencia um sistema de diálogo em um jogo, controlando a exibição de balões de diálogo, textos, músicas e interações do jogador.

### Sinais

- **`entered_dialog(onDialog:bool)`**: Emitido quando um diálogo é iniciado ou terminado.
  - **`onDialog`**: `true` se um diálogo foi iniciado, `false` se um diálogo foi concluído.

### Variáveis

- **`heroBaloon`**: Textura do balão de diálogo do herói.
- **`villainBaloon`**: Textura do balão de diálogo do vilão.
- **`dialogTexts`**: Lista de objetos contendo textos e personagens para os diálogos.
- **`dialogSongs`**: Lista de músicas associadas aos diálogos.
- **`textIndex`**: Índice do texto de diálogo atual.
- **`actionAfterDialog`**: Ação a ser realizada após o término do diálogo.
- **`paused`**: Indica se o jogo está pausado durante o diálogo.
- **`tween`**: Objeto de interpolação usado para animar a visibilidade do rótulo de diálogo.
- **`duracao_audio`**: Duração da música associada ao diálogo atual.
- **`pauseDialog`**: Indica se o diálogo está pausado.
- **`onDialog`**: Indica se um diálogo está em andamento.
- **`onPuzzle`**: Indica se um quebra-cabeça está em andamento.

### Métodos

#### `enableDialog(action, pause = true)`

- **Descrição**: Inicia um novo diálogo.
- **Parâmetros**:
  - `action`: Ação a ser realizada após o término do diálogo.
  - `pause` (opcional): Indica se o jogo deve ser pausado durante o diálogo (padrão: `true`).

#### `_process(_delta)`

- **Descrição**: Chamado a cada quadro para atualizar o estado do diálogo.
- **Ações**:
  - Exibe ou oculta o botão de próximo diálogo com base na visibilidade do rótulo de diálogo.
  - Avança para o próximo diálogo quando o jogador pressiona o botão de aceitar.

#### `_on_next_dialog_pressed()`

- **Descrição**: Chamado quando o botão de próximo diálogo é pressionado.
- **Ações**:
  - Avança para o próximo diálogo na sequência.

#### `nextDialog()`

- **Descrição**: Avança para o próximo diálogo na sequência.
- **Ações**:
  - Configura o texto, a música e a imagem do balão de diálogo de acordo com o diálogo atual.

#### `_on_texture_button_pressed()`

- **Descrição**: Chamado quando um botão de textura é pressionado.
- **Ações**:
  - Avança para o próximo diálogo na sequência.

## `healthbar.gd`

Este script gerencia a barra de vida do jogador, exibindo corações para representar a saúde atual e respondendo a eventos como receber danos ou recuperar vida.

### Exportações

- **`heartTexture`**: Textura do coração cheio.
- **`emptyHeartTexture`**: Textura do coração vazio.
  
### Constantes

- **`rebirthSong`**: Música pré-carregada para reprodução quando o jogador é revivido.

### Variáveis

- **`player`**: Referência ao nó do jogador na cena atual.
- **`allHearts`**: Lista que contém todas as instâncias de `TextureRect` representando os corações na barra de vida.

### Métodos

#### `_ready()`

- **Descrição**: Chamado quando o nó está pronto.
- **Ações**:
  - Adiciona os corações iniciais à barra de vida.

#### `addHeartToHealthBar()`

- **Descrição**: Adiciona corações à barra de vida com base na saúde atual.
- **Ações**:
  - Cria instâncias de `TextureRect` para cada coração, configura suas texturas e tamanhos com base na variável `Globals.health`.

#### `fullLife()`

- **Descrição**: Restaura a saúde do jogador para o máximo.
- **Ações**:
  - Define `Globals.health` para 3.
  - Atualiza todas as texturas dos corações para `heartTexture`.

#### `addLife()`

- **Descrição**: Adiciona uma vida à barra de vida se possível.
- **Ações**:
  - Incrementa `Globals.health` se for menor que 3.
  - Atualiza a textura do coração correspondente para `heartTexture`.

#### `hit(saveError: bool = false)`

- **Parâmetros**:
  - `saveError`: Indica se um erro deve ser salvo no sistema (padrão: `false`).
- **Descrição**: Processa um golpe recebido pelo jogador.
- **Ações**:
  - Reduz a saúde (`Globals.health`) em 1.
  - Atualiza a textura do coração correspondente para `emptyHeartTexture`.
  - Reproduz o som de golpe.
  - Se a saúde chegar a 0 ou menos, executa a lógica de morte do jogador, incluindo a reprodução de uma música especial (`rebirthSong`) e o recarregamento da cena atual.

#### `hitWithoutPlayer(saveError: bool = false)`

- **Parâmetros**:
  - `saveError`: Indica se um erro deve ser salvo no sistema (padrão: `false`).
- **Descrição**: Processa um golpe recebido pelo jogador quando o jogador não está disponível.
- **Ações**:
  - Reduz a saúde (`Globals.health`) em 1.
  - Atualiza a textura do coração correspondente para `emptyHeartTexture`.
  - Reproduz o som de golpe.
  - Se a saúde chegar a 0 ou menos, executa a lógica de morte do jogador sem o jogador presente, incluindo a reprodução de uma música especial (`rebirthSong`), e em caso de `saveError`, um erro é salvo no sistema antes de recarregar a cena.

## `joystick.gd`

Este script controla o comportamento do joystick no jogo, gerenciando a posição do eixo e o estado do botão.

### Variáveis

- **`positionAxis`**: Vetor que representa a posição atual do eixo do joystick.

### Métodos

#### `_ready()`

- **Descrição**: Chamado quando o nó está pronto.
- **Ações**:
  - Define o comportamento inicial do joystick, mostrando-o se o sistema operacional for Android e ocultando-o caso contrário. Comentários presentes indicam uma funcionalidade que foi potencialmente desativada (`if OS.has_feature("android")`).

#### `buttonDown()`

- **Descrição**: Reseta o estado do botão do joystick.
- **Ações**:
  - Define `isPressing` como `false` para indicar que o botão não está pressionado.
  - Zera o vetor `positionAxis`.

## `joystick_ball.gd`

Este script controla o comportamento visual e funcional do joystick no jogo, gerenciando sua posição em relação ao ponteiro do mouse e calculando um vetor de direção.

### Variáveis

- **`isPressing`**: Booleano que indica se o joystick está sendo pressionado.
- **`length`**: Comprimento máximo do joystick.
- **`deadZone`**: Zona morta, onde movimentos menores que isso não são considerados.

### Métodos

#### `_ready()`

- **Descrição**: Chamado quando o nó está pronto.
- **Ações**:
  - Ajusta o comprimento do joystick multiplicando pela escala do nó pai.

#### `_process(delta)`

- **Descrição**: Chamado a cada quadro do jogo.
- **Parâmetros**:
  - `delta`: Tempo decorrido desde o último quadro.
- **Ações**:
  - Se `isPressing` for verdadeiro:
    - Move o joystick para a posição do cursor se estiver dentro do comprimento máximo (`length`).
    - Caso contrário, calcula a posição do joystick ao longo da linha que conecta a origem ao cursor, limitado pelo `length`.
    - Chama `calculateVector()` para determinar o vetor direcional com base na posição atual do joystick.
  - Se `isPressing` for falso:
    - Usa a função de interpolação linear (`lerp`) para suavizar o retorno do joystick para a posição inicial.
    - Define `positionAxis` do nó pai como vetor nulo (`Vector2.ZERO`).

#### `calculateVector()`

- **Descrição**: Calcula o vetor direcional baseado na posição atual do joystick.
- **Ações**:
  - Calcula os componentes `x` e `y` do vetor `positionAxis` com base na posição do joystick em relação à posição global do nó pai e ao `length`.
  - Aplica uma zona morta (`deadZone`) para garantir que pequenos movimentos não sejam registrados.

#### `_on_button_button_down()`

- **Descrição**: Chamado quando o botão associado ao joystick é pressionado.
- **Ações**:
  - Define `isPressing` como verdadeiro.

#### `_on_button_button_up()`

- **Descrição**: Chamado quando o botão associado ao joystick é solto.
- **Ações**:
  - Define `isPressing` como falso.

## `pause.gd`

Este script gerencia a funcionalidade de pausa dentro do jogo, incluindo ajustes de volume, controle de diálogos e transições entre cenas.

### Variáveis

- **`volMusic`**: Volume da música, inicializado como 1.0.
- **`onDialog`**: Estado do diálogo.
- **`onPause`**: Indica se o jogo está pausado.
- **`onCutscene`**: Indica se uma cutscene está em execução.

### Sinais

- **`vol_music_changed(new_value: float)`**: Emitido quando o volume da música é alterado.
  - **`new_value`**: Novo valor do volume da música.

### Métodos

#### `_ready()`

- **Descrição**: Chamado quando o nó está pronto.
- **Ações**:
  - Inicializa `volMusic` com o valor global `Globals.volMusic`.
  - Se disponível, configura o valor do slider de volume `$volSlider` com `Globals.volMusic`.
  - Verifica e ajusta `onDialog` com base no estado do diálogo no nó pai `Control/playerSpeak`.
  - Define `onPause` como verdadeiro.
  - Esconde o nó.
  - Emite o sinal `vol_music_changed` com `volMusic`.
  - Esconde o botão "return_to_base" se `Globals.world` for 0.

#### `_process(delta)`

- **Descrição**: Chamado a cada quadro do jogo.
- **Parâmetros**:
  - `delta`: Tempo decorrido desde o último quadro.
- **Ações**:
  - Atualiza `onDialog` com o estado do diálogo no nó pai `Control/playerSpeak`.

#### `_on_continue_pressed()`

- **Descrição**: Chamado quando o botão "continue" é pressionado.
- **Ações**:
  - Despausa o jogo se não houver diálogo (`onDialog` falso).
  - Desativa a pausa do diálogo no nó pai se `onCutscene` for falso.
  - Esconde o nó de pausa.
  - Define `onPause` como falso.

#### `_on_background_pressed()`

- **Descrição**: Chamado quando a área de fundo é pressionada.
- **Ações**:
  - Despausa o jogo se não houver diálogo (`onDialog` falso).
  - Desativa a pausa do diálogo no nó pai se `onCutscene` for falso.
  - Esconde o nó de pausa.
  - Define `onPause` como falso.

#### `_on_exit_pressed()`

- **Descrição**: Chamado quando o botão "exit" é pressionado.
- **Ações**:
  - Limpa as variáveis globais (`Globals.clearGlobals()`).
  - Altera a cena para a tela de login (`SceneManager.changeScene("res://screens/login/login.screen.tscn")`).
  - Desativa a pausa do diálogo no nó pai se `onCutscene` for falso.

#### `_on_return_to_base_pressed()`

- **Descrição**: Chamado quando o botão "return_to_base" é pressionado.
- **Ações**:
  - Despausa o jogo.
  - Define a próxima cena como a cena da base de operações e carrega a tela de carregamento (`SceneManager.changeScene("res://screens/loading/loading_screen.screen.tscn")`).
  - Desativa a pausa do diálogo no nó pai se `onCutscene` for falso.

#### `_on_pause_button_down()`

- **Descrição**: Chamado quando o botão de pausa é pressionado.
- **Ações**:
  - Define `onPause` como verdadeiro.
  - Mostra o nó de pausa.
  - Pausa o jogo se não houver diálogo (`onDialog` falso).
  - Ativa a pausa do diálogo no nó pai.

#### `_on_h_slider_value_changed(value)`

- **Parâmetros**:
  - `value`: Novo valor do slider de volume.
- **Ações**:
  - Atualiza `volMusic` com o novo valor.
  - Armazena `volMusic` globalmente (`Globals.volMusic`).
  - Emite o sinal `vol_music_changed` com o novo `volMusic`.

#### `pauseCutscene()`

- **Descrição**: Pausa o jogo durante uma cutscene.
- **Ações**:
  - Define `onCutscene` e `onPause` como verdadeiros.
  - Mostra o nó de pausa.
  - Pausa o jogo.

#### `_on_close_game_pressed()`

- **Descrição**: Chamado quando o botão de fechar jogo é pressionado.
- **Ações**:
  - Fecha o jogo.

## `dialogs.gd`

Este script gerencia diálogos e áudios relacionados a um minigame de plataformas, dependendo das configurações fornecidas.

### Variáveis

- **`dialogs`**: Array que armazena os diálogos com seus textos e personagens associados.
- **`dialogAudios`**: Array que armazena os áudios dos diálogos.
- **`player`**: Objeto que contém expressões do jogador.
- **`expressions`**: Instância do script `get_files_from_folder.gd`, utilizado para carregar expressões do jogador.
- **`folderAudioFormas`**: Caminho para a pasta que contém áudios relacionados a formas no minigame.
- **`folderAudioNumeros`**: Caminho para a pasta que contém áudios relacionados a números no minigame.

### Métodos

#### `_ready()`

- **Descrição**: Chamado quando o nó entra na árvore de cena pela primeira vez.
- **Ações**:
  - Inicializa `player` com expressões do jogador carregadas através de `expressions.getFrames`.
  
#### `_process(delta)`

- **Descrição**: Chamado a cada quadro do jogo, mas não realiza ações neste script.

#### `getDialogs(value:String, numbers:String, formas:bool) -> Array`

- **Parâmetros**:
  - `value` (String): Tipo de forma (`"rectangle"`, `"triangle"`, `"arrow"`).
  - `numbers` (String): Tipo de número (`"unidades"`, `"dezenas"`, `"ordinal"`, `"meses"`, `"horas"`, `"dias_semana"`, `"multiplicacao"`).
  - `formas` (bool): Indica se o diálogo é sobre formas (`true`) ou números (`false`).
- **Retorno**: Array contendo os diálogos e seus respectivos textos e personagens.
- **Ações**:
  - Limpa `dialogAudios` para preparar para novos áudios.
  - Adiciona diálogos com base nos parâmetros fornecidos:
    - Texto e personagem para o início do minigame.
    - Áudio correspondente para cada diálogo.
    - Dependendo de `formas`, adiciona diálogos e áudios para diferentes tipos de formas ou números.
  - Adiciona um último aviso sobre as consequências de escolhas erradas no minigame.
- **Nota**: Os diálogos e áudios são organizados em `dialogs` e `dialogAudios` respectivamente e são retornados ao chamar este método.

#### `getAudios()`

- **Retorno**: Array contendo todos os áudios dos diálogos.

# `UI.Screen.gd`

Este script gerencia diálogos e interações relacionadas ao jogo, controlando transições, diálogos de personagens e interações específicas de gameplay.

## Propriedades Exportadas

- **`healthbar`**: Booleano que controla a visibilidade da barra de vida.
- **`music`**: Stream de áudio para música de fundo.
- **`loopPath`**: Diretório para loops de áudio.
- **`dialogs`**: Gerenciamento de diálogos.
- **`current_dialogs`**: Lista de diálogos atuais.

## Sinais

- **`transitionFinished(node)`**: Emitido quando uma transição de cena é finalizada.
- **`onDialog(onDialog: bool)`**: Emitido ao iniciar ou parar um diálogo.
- **`bossHealthBarIsSecondStage`**: Emitido quando a barra de vida do chefe atinge a segunda fase.

## Métodos

### `_ready()`

Inicializa o script quando o nó entra na árvore de cena:
- Configura visibilidade do joystick e botão de corrida com base no ambiente.
- Inicializa variáveis globais e configuração inicial de moedas.
- Configura visibilidade da barra de vida dependendo da cena atual.

### `_input(event)`

Método para gerenciar entrada de usuário (toques ou cliques na tela):
- Controla a exibição de elementos de interface com base no evento de toque.
- Gerencia a exibição e ocultação de elementos de interface durante a interação do usuário.

### `fadeIn()`

Método para realizar uma transição de fade-in na tela:
- Inicia uma animação de fade-in usando um nó Tween.

### `extFadeIn(node)`

Inicia uma transição de fade-in especificando um nó de transição.

### `changeLevel(node)`

Inicia a transição de nível especificando o nó de destino.

### `showMouse(show_mouse)`

Controla a visibilidade do cursor do mouse na tela.

### `showJoystick(show_joystick)`

Controla a visibilidade do joystick na tela, especialmente útil para dispositivos Android.

### `startTutorial()`

Inicia o tutorial do jogo, configurando diálogos e expressões para introdução.

### `endTutorial()`

Finaliza o tutorial do jogo, configurando diálogos e expressões para conclusão.

### `_on_laser_interaction_body_entered(body)`

Método chamado quando o corpo entra na zona de interação do laser.

### `setItemToVisible(isVisible)`

Controla a visibilidade de um item específico no jogo.

### `_on_cristal_collide_body_entered(body)`

Método chamado quando o corpo colide com o cristal.

### `_on_security_door_body_entered(body)`

Método chamado quando o corpo entra na porta de segurança.

### `_on_area_porta_body_entered(body)`

Método chamado quando o corpo entra na área da porta.

### `update_Plataformdialogs(value: String, numbers: String, formas: bool)`

Atualiza os diálogos específicos da plataforma com base nos parâmetros fornecidos.

### `_on_colisaoplataforma_body_entered(body)`

Método chamado quando o corpo entra na plataforma de colisão.

### `start_dialog(dialogs: Array, audios)`

Inicia um diálogo com os diálogos e áudios especificados.

### `_on_animation_player_animation_finished(anim_name)`

Método chamado quando uma animação de transição é finalizada.

### `_on_player_speak_entered_dialog(onDialog)`

Método chamado quando o jogador entra em um diálogo.

### `setCoinsOnStart()`

Configura a quantidade inicial de moedas no início do jogo.

### `hitWithoutPlayer()`

Executa a ação de atingir sem o jogador.

### `addCoin(qntd=1)`

Adiciona uma quantidade específica de moedas ao jogo.

### `setCoins(qntd)`

Define a quantidade total de moedas no jogo.

### `finishLevel()`

Finaliza o nível atual do jogo, exibindo estatísticas e enviando informações.

### `setFinishLevelVariables()`

Define variáveis após a conclusão do nível, como melhor tempo e moedas coletadas.

### `checkBestTime()`

Verifica e atualiza o melhor tempo para o nível atual.

### `setFullLife()`

Restaura a vida completa do jogador.

### `_on_timer_timeout()`

Método chamado quando o temporizador atinge o tempo limite.

### `_on_health_bar_is_second_stage()`

Método chamado quando a barra de vida do chefe atinge a segunda fase.

### `_on_helper_pressed()`

Método chamado quando o botão de ajuda é pressionado.

---

Este script implementa funcionalidades essenciais para o gerenciamento de diálogos, transições de cena e interações específicas do jogo, proporcionando uma estrutura organizada e clara para desenvolvimento e manutenção do código.


## `nomeEscola.gd`

Este script é responsável por configurar dinamicamente o texto de um nó de Label com base na variável global `Globals.nomeEscola`.

### Herança

- Herda de `Label`, indicando que este script estende as funcionalidades de um nó de Label.

### Métodos

#### `_ready()`

Chamado quando o nó entra na árvore de cena pela primeira vez:
- Define o texto do nó Label com base no valor da variável global `Globals.nomeEscola`.

#### `_process(delta)`

Método chamado a cada quadro do jogo, mas não realiza ações neste script:
- Utilizado para processamento contínuo caso necessário, mas está vazio neste momento.

---

Este script é útil para exibir dinamicamente o nome da escola com base em uma variável global, proporcionando flexibilidade para ajustes futuros sem alterações diretas no código.


# `feedback.gd`

Este script estende as funcionalidades de um nó `Control` e é responsável por controlar a lógica de feedback e interação para uma tela de feedback de jogo.

## Herança

- Herda de `Control`, indicando que este script gerencia comportamentos de um nó de controle na cena.

## Métodos

### `_ready()`

Chamado quando o nó entra na árvore de cena pela primeira vez:
- Não realiza ações específicas neste momento.

### `_process(delta)`

Método chamado a cada quadro do jogo, mas não realiza ações neste script:
- Utilizado para processamento contínuo caso necessário, mas está vazio neste momento.

### `winSound()`

Reproduz o som de vitória:
- Chama o método `play()` no nó `$vitoria` para reproduzir o som de vitória.

### `formatSeconds(total_seconds: int) -> String`

Converte o tempo total em segundos para um formato de minutos e segundos (MM:SS):
- `total_seconds` (int): Total de segundos a ser formatado.
- Retorna uma string formatada no formato MM:SS representando o tempo total.

### `setStats()`

Atualiza as estatísticas exibidas na tela de feedback:
- Define o texto nos nós filhos de `$Panel` com base nas variáveis globais `Globals.wrongAnswers`, `Globals.totalCoins` e `Globals.timeLevel`.
- Ajusta as imagens das estrelas de acordo com o número de respostas incorretas (`Globals.wrongAnswers`).

### `_on_continue_pressed()`

Callback chamado quando o botão "continuar" é pressionado:
- Chama o método `changeScene` da classe `SceneManager` para mudar para a cena de seleção de nível (`res://screens/level-select/level-select.tscn`).

### `_on_menu_pressed()`

Callback chamado quando o botão "menu" é pressionado:
- Chama o método `changeScene` da classe `SceneManager` para mudar para a cena principal do jogo (`res://worlds/prologue.world_00/scenarios/endless.saving_the_amazon/saving_amazon_endless.scenario.tscn`).

---

Este script oferece funcionalidades para gerenciar feedback de jogo, incluindo reprodução de som, formatação de tempo, atualização de estatísticas e navegação entre cenas, proporcionando uma experiência interativa completa para o usuário.

# `tutorial_lock_minigame.gd`

Este script estende as funcionalidades de um nó `Node2D` e controla a lógica do minigame de travamento de tutorial.

## Variáveis

- **`gui`**: Referência ao nó pai contendo a interface gráfica do usuário.

## Métodos

### `openDoor()`

Abre a porta após completar o minigame:
- Ativa o jogo (`get_tree().paused = false`).
- Adiciona o nível atual à lista `Globals.completedLevels`.
- Chama o método `finishLevel()` no nó `$"../GUI"` para finalizar o nível.

### `transitionFinished(node)`

Callback chamado quando a transição do minigame é concluída:
- `node` (Node): Nó que finalizou a transição.
- Reproduz o som de sucesso (`$sucess.play()`).
- Salva a posição de reprodução da música atual em `Globals.musicStep`.
- Chama `SceneManager.changeScene()` para mudar para a cena do primeiro andar dos neutros (`res://worlds/prologue.world_00/scenarios/first_floor.neutros_base/first_floor_neutros.scenario.tscn`).

### `_on_area_2d_body_entered(body)`

Callback chamado quando o corpo entra na área 2D:
- `body` (Node): Corpo que entrou na área.
- Se o corpo for o jogador (`body.name == "player"`):
  - Obtém o nó do cadeado (`lock`) na interface gráfica.
  - Conecta o sinal `"unlocked"` do cadeado ao método `openDoor()`.
  - Conecta o sinal `"transitionFinished"` da interface gráfica ao método `transitionFinished(node)`.

---

Este script gerencia a lógica de interação e transição para o minigame de travamento de tutorial, controlando a abertura da porta após completar o desafio e mudando para a próxima cena após a transição bem-sucedida.
